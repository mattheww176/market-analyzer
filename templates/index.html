{% extends "base.html" %}

{% block content %}
<div class="light">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/enhancements.css') }}">
    <style>
        .analysis-output {
            white-space: pre-wrap;
            font-family: monospace;
            background-color: #f3f4f6;
            padding: 1.5rem;
            border-radius: 0.75rem;
            overflow-x: auto;
            transition: all 0.3s ease;
        }
        .loading {
            display: none;
        }
        
        /* Chart styles */
        #stockChart {
            width: 100% !important;
            height: 100% !important;
            min-height: 400px;
        }
        
        /* Analysis cards */
        .analysis-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .dark .analysis-card {
            background: #1f2937;
            border-color: #374151;
        }
        
        .analysis-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* Tab styles */
        .chart-tab {
            transition: all 0.2s ease;
            position: relative;
            padding-bottom: 0.5rem;
        }
        
        .chart-tab:after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -1px;
            left: 0;
            background-color: #3b82f6;
            transition: width 0.3s ease;
        }
        
        .chart-tab.active:after {
            width: 100%;
        }
        
        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #1f2937;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px 12px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.875rem;
            line-height: 1.5;
        }
        
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* Loading spinner */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        
        /* Dark mode styles */
        .dark .analysis-output {
            background-color: #1f2937;
            color: #f8fafc;  /* Brighter text for better readability */
        }
        
        .dark body {
            background-color: #111827;
            color: #f8fafc;  /* Brighter base text color */
        }
        
        .dark .bg-white {
            background-color: #1f2937;
        }
        
        /* Input field styles for dark mode */
        .dark input[type="text"],
        .dark input[type="number"],
        .dark select,
        .dark textarea {
            background-color: #374151 !important;
            color: #f3f4f6 !important;
            border-color: #4b5563 !important;
        }
        
        .dark input[type="text"]::placeholder,
        .dark input[type="number"]::placeholder {
            color: #9ca3af !important;
        }
        
        .dark .text-gray-800,
        .dark .text-gray-700,
        .dark .text-gray-600 {
            color: #f1f5f9;  /* Brighter text for better contrast */
        }
        
        .dark .text-gray-400,
        .dark .text-gray-500 {
            color: #cbd5e1;  /* Brighter secondary text */
        }
        
        .dark .bg-gray-100,
        .dark .bg-gray-50 {
            background-color: #1f2937;
        }
        
        /* Enhance contrast for better readability */
        .dark .border-gray-200,
        .dark .border-gray-300 {
            border-color: #374151;
        }
        
        .dark .shadow-md {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen transition-colors duration-200">
    <!-- Enhanced Navigation -->
    <nav class="bg-white shadow-sm dark:bg-gray-800 transition-colors duration-300 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <!-- Logo / Brand -->
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <a href="#" class="text-xl font-bold text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 transition-colors duration-200">
                            📈 Market Analyzer
                        </a>
                    </div>
                    <!-- Desktop Navigation -->
                    <div class="hidden md:ml-10 md:flex md:space-x-8">
                        <a href="#" class="text-gray-900 dark:text-white inline-flex items-center px-1 pt-1 border-b-2 border-blue-500 text-sm font-medium">
                            Home
                        </a>
                        <a href="#features" class="text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white inline-flex items-center px-1 pt-1 border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600 text-sm font-medium transition-colors duration-200">
                            Features
                        </a>
                        <a href="#guide" class="text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white inline-flex items-center px-1 pt-1 border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600 text-sm font-medium transition-colors duration-200">
                            Guide
                        </a>
                        <a href="#glossary" class="text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white inline-flex items-center px-1 pt-1 border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600 text-sm font-medium transition-colors duration-200">
                            Glossary
                        </a>
                        <a href="#about" class="text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white inline-flex items-center px-1 pt-1 border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600 text-sm font-medium transition-colors duration-200">
                            About
                        </a>
                    </div>
                </div>

                <!-- Right side items -->
                <div class="flex items-center space-x-2 sm:space-x-4">
                    <!-- Watchlist Button -->
                    <div class="relative">
                        <button id="watchlistButton" class="p-2 text-gray-600 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 focus:outline-none group transition-colors duration-200 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
                            <i class="fas fa-star text-xl"></i>
                            <span id="watchlistCount" class="absolute -top-1 -right-1 bg-blue-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                            <span class="absolute z-10 right-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 hidden group-hover:block">
                                <div class="px-4 py-2 text-sm text-gray-700 dark:text-gray-200 border-b border-gray-200 dark:border-gray-700">
                                    <span>Your Watchlist</span>
                                </div>
                                <div id="watchlistItems" class="max-h-60 overflow-y-auto">
                                    <div class="px-4 py-3 text-sm text-gray-500 dark:text-gray-400">
                                        No stocks in watchlist
                                    </div>
                                </div>
                                <div class="border-t border-gray-200 dark:border-gray-700 px-4 py-2">
                                    <button id="clearWatchlist" class="text-xs text-red-500 hover:text-red-700 dark:hover:text-red-400">
                                        Clear All
                                    </button>
                                </div>
                            </span>
                        </button>
                    </div>

                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200" aria-label="Toggle dark mode">
                        <i class="fas fa-moon text-gray-600 dark:text-yellow-300 text-xl"></i>
                    </button>

                    <!-- Mobile menu button -->
                    <div class="md:hidden flex items-center">
                        <button id="mobileMenuButton" class="inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 transition-colors duration-200" aria-expanded="false">
                            <span class="sr-only">Open main menu</span>
                            <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile menu, show/hide based on menu state -->
        <div id="mobileMenu" class="md:hidden hidden">
            <div class="pt-2 pb-3 space-y-1">
                <a href="#" class="bg-blue-50 border-blue-500 text-blue-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium dark:bg-gray-700 dark:text-blue-300">
                    Home
                </a>
                <a href="#features" class="border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-base font-medium dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-white">
                    Features
                </a>
                <a href="#guide" class="border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-base font-medium dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-white">
                    Guide
                </a>
                <a href="#about" class="border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-base font-medium dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-white">
                    About
                </a>
            </div>
        </div>
    </nav>
    
    <!-- Add this script for mobile menu toggle -->
    <script>
        document.getElementById('mobileMenuButton').addEventListener('click', function() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
            this.setAttribute('aria-expanded', !(this.getAttribute('aria-expanded') === 'true'));
        });
    </script>

    <div class="max-w-4xl mx-auto p-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800 dark:text-white mb-2">Stock Analysis Dashboard</h1>
            <p class="text-gray-600 dark:text-gray-400">Get detailed technical analysis and performance metrics</p>
        </header>

        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8 transition-colors duration-200">
            <form id="analysisForm" class="space-y-6" novalidate>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Stock Ticker Input -->
                    <div class="space-y-2">
                        <label for="ticker" class="block text-sm font-medium text-gray-700 dark:text-gray-300">
                            Stock Ticker
                            <span class="text-red-500">*</span>
                        </label>
                        <div class="relative mt-1 rounded-md shadow-sm">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-chart-line text-gray-400"></i>
                            </div>
                            <input type="text" 
                                   id="ticker" 
                                   name="ticker" 
                                   placeholder="e.g., AAPL, MSFT, GOOG" 
                                   class="block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"
                                   autocomplete="off"
                                   autocapitalize="characters"
                                   maxlength="10">
                        </div>
                        <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Enter a valid stock ticker symbol</p>
                    </div>
                    
                    <!-- Analysis Period -->
                    <div class="space-y-2">
                        <label for="days" class="block text-sm font-medium text-gray-700 dark:text-gray-300">
                            Analysis Period
                        </label>
                        <div class="relative mt-1">
                            <select id="days" 
                                    name="days" 
                                    class="block w-full pl-3 pr-10 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
                                <option value="30">1 Month</option>
                                <option value="90" selected>3 Months</option>
                                <option value="180">6 Months</option>
                                <option value="365">1 Year</option>
                                <option value="custom">Custom...</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                <i class="fas fa-calendar-alt text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Custom Days Input (initially hidden) -->
                    <div id="customDaysContainer" class="hidden space-y-2">
                        <label for="customDays" class="block text-sm font-medium text-gray-700 dark:text-gray-300">
                            Custom Days (1-365)
                        </label>
                        <input type="number" 
                               id="customDays" 
                               name="customDays" 
                               min="1" 
                               max="365" 
                               value="90"
                               class="block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    
                    <!-- Analysis Type -->
                    <div class="space-y-2">
                        <span class="block text-sm font-medium text-gray-700 dark:text-gray-300">
                            Analysis Type
                        </span>
                        <div class="mt-1 space-y-2">
                            <div class="flex items-center">
                                <input id="analysis-basic" name="analysisType" type="radio" value="basic" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700" checked>
                                <label for="analysis-basic" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">
                                    Basic Analysis
                                </label>
                            </div>
                            <div class="flex items-center">
                                <input id="analysis-technical" name="analysisType" type="radio" value="technical" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700">
                                <label for="analysis-technical" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">
                                    Technical Analysis
                                </label>
                            </div>
                            <div class="flex items-center">
                                <input id="analysis-full" name="analysisType" type="radio" value="full" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700">
                                <label for="analysis-full" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">
                                    Full Analysis
                                </label>
                            </div>
                            <div class="flex items-center">
                                <input id="analysis-prediction" name="analysisType" type="radio" value="prediction" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700">
                                <label for="analysis-prediction" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">
                                    Prediction Analysis <span class="ml-1 px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded-full dark:bg-blue-900/30 dark:text-blue-300">New</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Additional Options -->
                    <div class="space-y-3">
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="show-charts" name="showCharts" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded" checked>
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="show-charts" class="font-medium text-gray-700 dark:text-gray-300">Show Interactive Charts</label>
                                <p class="text-gray-500 dark:text-gray-400">Display price and volume charts</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="email-report" name="emailReport" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded">
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="email-report" class="font-medium text-gray-700 dark:text-gray-300">Email me the report</label>
                                <p class="text-gray-500 dark:text-gray-400">Get a detailed report in your inbox</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                    <div class="flex justify-between items-center">
                        <button type="button" 
                                class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            <i class="fas fa-history mr-2"></i>
                            View History
                        </button>
                        <div class="flex space-x-3">
                            <button type="reset" 
                                    class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Reset
                            </button>
                            <button type="submit" 
                                    class="inline-flex items-center px-6 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200">
                                <i class="fas fa-chart-bar mr-2"></i>
                                Analyze Stock
                                <i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <div id="loading" class="text-center py-8 loading hidden">
            <div class="inline-flex items-center justify-center space-x-3">
                <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div>
                <div>
                    <p class="text-gray-700 dark:text-gray-300 font-medium">Analyzing stock data...</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1" id="loadingStatus">Fetching latest market data</p>
                </div>
            </div>
        </div>

        <div id="results" class="bg-white dark:bg-gray-800 rounded-xl shadow-xl p-6 hidden transition-all duration-300">
            <!-- Stock Header -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 pb-6 border-b border-gray-200 dark:border-gray-700">
                <div class="mb-4 md:mb-0">
                    <div class="flex items-center">
                        <h2 class="text-3xl font-bold text-gray-900 dark:text-white" id="stockTicker">BBAI</h2>
                        <span class="ml-3 px-3 py-1 text-sm font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200">
                            NASDAQ
                        </span>
                    </div>
                    <p class="text-gray-600 dark:text-gray-300 mt-1" id="companyName">BigBear.ai Holdings, Inc.</p>
                </div>
                <div class="flex items-center space-x-3">
                    <button id="addToWatchlistBtn" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 hover:text-yellow-500 dark:text-gray-400 dark:hover:text-yellow-400 transition-colors" title="Add to watchlist">
                        <i class="far fa-star text-xl"></i>
                    </button>
                    <button id="exportPdf" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 hover:text-red-500 dark:text-gray-400 dark:hover:text-red-400" title="Export to PDF">
                        <i class="fas fa-file-pdf text-lg"></i>
                    </button>
                    <button id="exportCsv" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 hover:text-green-500 dark:text-gray-400 dark:hover:text-green-400" title="Export to CSV">
                        <i class="fas fa-file-csv text-lg"></i>
                    </button>
                    <button id="printResults" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 hover:text-blue-500 dark:text-gray-400 dark:hover:text-blue-400" title="Print">
                        <i class="fas fa-print text-lg"></i>
                    </button>
                </div>
            </div>
            
            <!-- Price and Key Metrics -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <!-- Current Price Card -->
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-6 rounded-xl border border-blue-100 dark:border-blue-800/30">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 id="stockSymbol" class="text-xl font-bold text-gray-900 dark:text-white">-</h3>
                            <p id="stockName" class="text-sm text-gray-500 dark:text-gray-400">-</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-4 text-center mt-4 md:mt-0 w-full md:w-auto">
                        <div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Current</p>
                            <p id="currentPrice" class="text-lg font-semibold text-gray-900 dark:text-white">-</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Change</p>
                            <p id="priceChange" class="text-lg font-semibold">-</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">% Change</p>
                            <p id="percentChange" class="text-lg font-semibold">-</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Chart Tabs -->
            <div class="mb-6">
                <div class="border-b border-gray-200 dark:border-gray-700">
                    <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                        <button data-tab="price" class="tab-button border-blue-500 text-blue-600 dark:text-blue-400 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                            Price Chart
                        </button>
                        <button data-tab="volume" class="tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                            Volume
                        </button>
                        <button data-tab="rsi" class="tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                            RSI
                        </button>
                        <button data-tab="macd" class="tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                            MACD
                        </button>
                        <button data-tab="fundamental" class="tab-button border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                            <i class="fas fa-chart-pie mr-1"></i> Fundamental Analysis
                        </button>
                    </nav>
                </div>
            </div>
            
            <!-- Chart Container -->
            <div class="relative h-96 mb-6">
                <canvas id="stockChart"></canvas>
                <div id="chartLoading" class="absolute inset-0 flex items-center justify-center bg-white/80 dark:bg-gray-800/80 hidden">
                </div>
            </div>

            <!-- Technical Analysis Section -->
            <div id="technicalAnalysisSection" class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 mb-8">
                <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-6 flex items-center">
                    <i class="fas fa-chart-bar text-blue-500 mr-2"></i>
                    Technical Analysis
                </h3>
                
                <div class="space-y-6">
                    <!-- RSI Analysis -->
                    <div class="analysis-card">
                        <div class="flex items-center justify-between cursor-pointer" data-toggle="rsi-analysis">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-3">
                                    <i class="fas fa-wave-square text-blue-500"></i>
                                </div>
                                <h4 class="text-lg font-medium text-gray-900 dark:text-white">RSI Analysis</h4>
                            </div>
                            <div class="flex items-center">
                                <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200 mr-3">
                                    Oversold
                                </span>
                                <i class="fas fa-chevron-down text-gray-400 transition-transform" id="rsi-arrow"></i>
                            </div>
                        </div>
                        <div id="rsi-analysis" class="mt-4 pl-13 hidden">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Current RSI</p>
                                    <div class="flex items-baseline">
                                        <span class="text-2xl font-bold text-gray-900 dark:text-white">25.6</span>
                                        <span class="ml-2 text-sm text-gray-500 dark:text-gray-400">/ 70</span>
                                    </div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">14-Day Average</p>
                                    <div class="text-2xl font-bold text-gray-900 dark:text-white">32.4</div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Signal Strength</p>
                                    <div class="flex items-center">
                                        <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5 mr-2">
                                            <div class="bg-red-500 h-2.5 rounded-full" style="width: 36.6%"></div>
                                        </div>
                                        <span class="text-sm font-medium text-red-600 dark:text-red-400">Weak</span>
                                    </div>
                                </div>
                            </div>
                            <div class="prose prose-sm dark:prose-invert max-w-none">
                                <p>The RSI is currently in the oversold territory (below 30), which traditionally indicates a potential buying opportunity. However, in strong downtrends, RSI can remain oversold for extended periods. The current RSI of 25.6 suggests the stock is oversold, but confirmation from other indicators is recommended before making a trading decision.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Moving Averages -->
                    <div class="analysis-card">
                        <div class="flex items-center justify-between cursor-pointer" data-toggle="ma-analysis">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-3">
                                    <i class="fas fa-chart-line text-blue-500"></i>
                                </div>
                                <h4 class="text-lg font-medium text-gray-900 dark:text-white">Moving Averages</h4>
                            </div>
                            <i class="fas fa-chevron-down text-gray-400 transition-transform" id="ma-arrow"></i>
                        </div>
                        <div id="ma-analysis" class="mt-4 pl-13 hidden">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">20-Day MA</p>
                                    <div class="text-2xl font-bold text-gray-900 dark:text-white">$5.25</div>
                                    <p class="text-xs text-red-600 dark:text-red-400 mt-1">-7.2% vs current</p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">50-Day MA</p>
                                    <div class="text-2xl font-bold text-gray-900 dark:text-white">$6.36</div>
                                    <p class="text-xs text-red-600 dark:text-red-400 mt-1">-23.4% vs current</p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">200-Day MA</p>
                                    <div class="text-2xl font-bold text-gray-900 dark:text-white">$4.12</div>
                                    <p class="text-xs text-green-600 dark:text-green-400 mt-1">+18.2% vs current</p>
                                </div>
                            </div>
                            <div class="prose prose-sm dark:prose-invert max-w-none">
                                <p>The stock is currently trading below both its 20-day and 50-day moving averages, indicating a bearish trend in the short to medium term. However, it remains above the 200-day moving average, which could act as a support level. The 20-day MA recently crossed below the 50-day MA, which is typically considered a bearish signal (Death Cross).</p>
                            </div>
                        </div>
                    </div>

                    <!-- Volume Analysis -->
                    <div class="analysis-card">
                        <div class="flex items-center justify-between cursor-pointer" data-toggle="volume-analysis">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-3">
                                    <i class="fas fa-chart-pie text-blue-500"></i>
                                </div>
                                <h4 class="text-lg font-medium text-gray-900 dark:text-white">Volume Analysis</h4>
                            </div>
                            <i class="fas fa-chevron-down text-gray-400 transition-transform" id="volume-arrow"></i>
                        </div>
                        <div id="volume-analysis" class="mt-4 pl-13 hidden">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Today's Volume</p>
                                    <div class="text-2xl font-bold text-gray-900 dark:text-white">60.5M</div>
                                    <p class="text-xs text-green-600 dark:text-green-400 mt-1">+36% vs avg</p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Volume Ratio</p>
                                    <div class="text-2xl font-bold text-gray-900 dark:text-white">1.36x</div>
                                    <p class="text-xs text-green-600 dark:text-green-400 mt-1">Above average</p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Volume Trend</p>
                                    <div class="flex items-center">
                                        <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                                        <span class="text-lg font-bold text-green-600 dark:text-green-400">Increasing</span>
                                    </div>
                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Last 5 days</p>
                                </div>
                            </div>
                            <div class="prose prose-sm dark:prose-invert max-w-none">
                                <p>Volume has been increasing over the past few days, with today's volume 36% above the 15-day average. The rising volume on down days suggests strong selling pressure, but the recent increase in volume could also indicate capitulation, which often precedes a reversal. The volume profile shows significant support around the $4.70 level.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fundamental Analysis Section -->
            <div id="fundamentalAnalysisSection" class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 mb-8 hidden">
                <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-6 flex items-center">
                    <i class="fas fa-chart-pie text-blue-500 mr-2"></i>
                    Fundamental Analysis
                </h3>
                
                <!-- Loading Indicator -->
                <div id="fundamental-loading" class="text-center py-8">
                    <div class="inline-flex items-center justify-center space-x-3">
                        <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div>
                        <span class="text-gray-600 dark:text-gray-300">Loading fundamental data...</span>
                    </div>
                </div>
                
                <!-- Error Message -->
                <div id="fundamental-error" class="bg-red-50 dark:bg-red-900/30 border-l-4 border-red-500 p-4 mb-6 rounded-lg hidden">
                    <div class="flex items-start">
                        <div class="flex-shrink-0 pt-0.5">
                            <i class="fas fa-exclamation-circle text-red-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-red-700 dark:text-red-200"></p>
                        </div>
                    </div>
                </div>
                
                <!-- Content will be loaded here -->
                <div id="fundamental-content" class="space-y-6">
                
                <div class="space-y-6">
                    <!-- Valuation Metrics -->
                    <div class="analysis-card">
                        <div class="flex items-center justify-between cursor-pointer" data-toggle="valuation-metrics">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-3">
                                    <i class="fas fa-dollar-sign text-blue-500"></i>
                                </div>
                                <h4 class="text-lg font-medium text-gray-900 dark:text-white">Valuation Metrics</h4>
                            </div>
                            <i class="fas fa-chevron-down text-gray-400 transition-transform" id="valuation-arrow"></i>
                        </div>
                        <div id="valuation-metrics" class="mt-4 pl-13 hidden">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">P/E Ratio</p>
                                    <div id="pe-ratio" class="text-2xl font-bold text-gray-900 dark:text-white">-</div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">P/S Ratio</p>
                                    <div id="ps-ratio" class="text-2xl font-bold text-gray-900 dark:text-white">-</div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">P/B Ratio</p>
                                    <div id="pb-ratio" class="text-2xl font-bold text-gray-900 dark:text-white">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Health -->
                    <div class="analysis-card">
                        <div class="flex items-center justify-between cursor-pointer" data-toggle="financial-health">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-3">
                                    <i class="fas fa-heartbeat text-blue-500"></i>
                                </div>
                                <h4 class="text-lg font-medium text-gray-900 dark:text-white">Financial Health</h4>
                            </div>
                            <i class="fas fa-chevron-down text-gray-400 transition-transform" id="financial-arrow"></i>
                        </div>
                        <div id="financial-health" class="mt-4 pl-13 hidden">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Current Ratio</p>
                                    <div id="current-ratio" class="text-2xl font-bold text-gray-900 dark:text-white">-</div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Debt/Equity</p>
                                    <div id="debt-equity" class="text-2xl font-bold text-gray-900 dark:text-white">-</div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Quick Ratio</p>
                                    <div id="quick-ratio" class="text-2xl font-bold text-gray-900 dark:text-white">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Growth Metrics -->
                    <div class="analysis-card">
                        <div class="flex items-center justify-between cursor-pointer" data-toggle="growth-metrics">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-3">
                                    <i class="fas fa-chart-line text-blue-500"></i>
                                </div>
                                <h4 class="text-lg font-medium text-gray-900 dark:text-white">Growth Metrics</h4>
                            </div>
                            <i class="fas fa-chevron-down text-gray-400 transition-transform" id="growth-arrow"></i>
                        </div>
                        <div id="growth-metrics" class="mt-4 pl-13 hidden">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Revenue Growth (YoY)</p>
                                    <div id="revenue-growth" class="text-2xl font-bold text-gray-900 dark:text-white">-</div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-300 mb-1">Earnings Growth (YoY)</p>
                                    <div id="earnings-growth" class="text-2xl font-bold text-gray-900 dark:text-white">-</div>
                                </div>
                            </div>
                            <div class="prose prose-sm dark:prose-invert max-w-none">
                                <p id="growth-summary" class="text-gray-600 dark:text-gray-300">Loading growth metrics...</p>
                            </div>
                        </div>
                    </div>
                </div>
                </div> <!-- Close fundamental-content div -->
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4">
                <button id="addToWatchlistBottom" class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200">
                    <i class="far fa-star mr-2"></i> Add to Watchlist
                </button>
                <button id="setPriceAlert" class="inline-flex items-center justify-center px-6 py-3 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:hover:bg-gray-600 transition-colors duration-200">
                    <i class="fas fa-bell mr-2"></i> Set Price Alert
                </button>
                <button id="viewAdvancedCharts" class="inline-flex items-center justify-center px-6 py-3 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:hover:bg-gray-600 transition-colors duration-200">
                    <i class="fas fa-chart-candlestick mr-2"></i> Advanced Charts
                </button>
            </div>

            <!-- Analysis Output -->
            <div class="analysis-output bg-gray-50 dark:bg-gray-700/30 rounded-lg p-4" id="analysisOutput">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white">Stock Analysis</h3>
                    <button id="addToWatchlist" 
                            class="inline-flex items-center px-3 py-1.5 text-xs font-medium rounded-md bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-200 transition-colors duration-200"
                            data-ticker="">
                        <i class="far fa-star mr-1"></i> Add to Watchlist
                    </button>
                </div>
                <div class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                            <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Price Summary</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-300">Open</span>
                                    <span id="openPrice" class="font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-300">High</span>
                                    <span id="highPrice" class="font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-300">Low</span>
                                    <span id="lowPrice" class="font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-300">Close</span>
                                    <span id="closePrice" class="font-medium">-</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                            <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Technical Indicators</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-300">RSI (14)</span>
                                    <span id="rsiValue" class="font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-300">MACD</span>
                                    <span id="macdValue" class="font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-300">SMA (50)</span>
                                    <span id="sma50" class="font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-300">SMA (200)</span>
                                    <span id="sma200" class="font-medium">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                        <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Analysis</h4>
                        <div id="analysisText" class="prose prose-sm dark:prose-invert max-w-none">
                            Run an analysis to see detailed results
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="error" class="bg-red-50 dark:bg-red-900/30 border-l-4 border-red-500 p-4 mb-6 rounded-lg hidden transition-all duration-300">
            <div class="flex items-start">
                <div class="flex-shrink-0 pt-0.5">
                    <i class="fas fa-exclamation-triangle h-5 w-5 text-red-500 dark:text-red-400"></i>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-red-800 dark:text-red-100">Error Processing Request</h3>
                    <div class="mt-1 text-sm text-red-700 dark:text-red-200" id="errorMessage"></div>
                    <div class="mt-2">
                        <button type="button" onclick="document.getElementById('error').classList.add('hidden')" 
                                class="text-sm font-medium text-red-800 dark:text-red-200 hover:text-red-900 dark:hover:text-red-100 focus:outline-none">
                            Dismiss
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="error" class="bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded hidden">
            <div class="flex">
                <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                    </svg>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-red-700" id="errorMessage"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Stock Analysis Guide Section -->
    <section id="guide" class="py-16 bg-white dark:bg-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white sm:text-4xl">
                    Stock Analysis Guide
                </h2>
                <p class="mt-4 text-xl text-gray-600 dark:text-gray-300">
                    Understanding the key concepts of stock analysis
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-16">
                <!-- Technical Analysis -->
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 p-3 rounded-lg">
                                <i class="fas fa-chart-line text-blue-500 text-xl"></i>
                            </div>
                            <h3 class="ml-3 text-xl font-semibold text-gray-900 dark:text-white">Technical Analysis</h3>
                        </div>
                        <div class="space-y-4">
                            <p class="text-gray-600 dark:text-gray-300">
                                Technical analysis focuses on statistical trends gathered from trading activity, such as price movement and volume. It operates under the assumption that historical trading activity and price changes can be valuable indicators of future price movements.
                            </p>
                            <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                                <h4 class="font-medium text-blue-800 dark:text-blue-200">Key Principles:</h4>
                                <ul class="mt-2 text-sm text-blue-700 dark:text-blue-300 list-disc list-inside space-y-1">
                                    <li>Price moves in trends that tend to persist</li>
                                    <li>Market action discounts everything</li>
                                    <li>History tends to repeat itself</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fundamental Analysis -->
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="flex-shrink-0 bg-green-100 dark:bg-green-900/30 p-3 rounded-lg">
                                <i class="fas fa-building text-green-500 text-xl"></i>
                            </div>
                            <h3 class="ml-3 text-xl font-semibold text-gray-900 dark:text-white">Fundamental Analysis</h3>
                        </div>
                        <div class="space-y-4">
                            <p class="text-gray-600 dark:text-gray-300">
                                Fundamental analysis examines economic and financial factors to determine the intrinsic value of a security. It looks at everything from the overall economy and industry conditions to the financial condition and management of companies.
                            </p>
                            <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg">
                                <h4 class="font-medium text-green-800 dark:text-green-200">Key Areas:</h4>
                                <ul class="mt-2 text-sm text-green-700 dark:text-green-300 list-disc list-inside space-y-1">
                                    <li>Financial statements analysis</li>
                                    <li>Industry conditions</li>
                                    <li>Economic factors</li>
                                    <li>Company management</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Stock Analysis Glossary Section -->
    <section id="glossary" class="py-16 bg-gray-50 dark:bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white sm:text-4xl">
                    Stock Analysis Glossary
                </h2>
                <p class="mt-4 text-xl text-gray-600 dark:text-gray-300">
                    Key terms and abbreviations explained
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Technical Analysis Terms -->
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 p-3 rounded-lg">
                                <i class="fas fa-chart-line text-blue-500 text-xl"></i>
                            </div>
                            <h3 class="ml-3 text-xl font-semibold text-gray-900 dark:text-white">Technical Terms</h3>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">SMA (Simple Moving Average)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    The average stock price over a specific time period, recalculated regularly.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">EMA (Exponential Moving Average)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A type of moving average that gives more weight to recent prices.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">RSI (Relative Strength Index)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A momentum indicator that measures the speed and change of price movements (0-100 scale).
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">MACD (Moving Average Convergence Divergence)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A trend-following momentum indicator showing the relationship between two moving averages.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">Bollinger Bands</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A volatility indicator showing a moving average with upper and lower price bands.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fundamental Analysis Terms -->
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="flex-shrink-0 bg-green-100 dark:bg-green-900/30 p-3 rounded-lg">
                                <i class="fas fa-building text-green-500 text-xl"></i>
                            </div>
                            <h3 class="ml-3 text-xl font-semibold text-gray-900 dark:text-white">Fundamental Terms</h3>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">P/E Ratio (Price-to-Earnings)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    Compares a company's stock price to its earnings per share (EPS).
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">P/B Ratio (Price-to-Book)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    Compares a company's market value to its book value (assets minus liabilities).
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">EPS (Earnings Per Share)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A company's profit divided by its number of outstanding shares.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">ROE (Return on Equity)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    Measures a company's profitability relative to shareholders' equity.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">EBITDA</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    Earnings Before Interest, Taxes, Depreciation, and Amortization - a measure of operating performance.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">VWAP (Volume Weighted Average Price)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    The average price a security has traded at throughout the day, based on both volume and price.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">Oversold/Overbought</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    Conditions where a security is considered to be trading below (oversold) or above (overbought) its intrinsic value, often measured by indicators like RSI.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">Volume Profile</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A charting technique that shows trading activity over a specific time period at specified price levels.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">Market Cap (Market Capitalization)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    The total market value of a company's outstanding shares, calculated as share price times number of shares.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">Dividend Yield</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A financial ratio showing how much a company pays out in dividends each year relative to its stock price.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">Current Ratio</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A liquidity ratio that measures a company's ability to pay short-term obligations with its current assets.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">Free Cash Flow (FCF)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    The cash a company generates after accounting for cash outflows to support operations and maintain capital assets.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">Beta (β)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A measure of a stock's volatility in relation to the overall market. A beta of 1 means the stock moves with the market.
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">Alpha (α)</h4>
                                <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">
                                    A measure of an investment's performance relative to a market index, representing the value added by the investment's manager.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-8 text-center text-sm text-gray-500 dark:text-gray-400">
                <p>These terms appear in the analysis above. Hover over any term in the app to see its definition.</p>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="py-16 bg-gray-50 dark:bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white sm:text-4xl">
                    Powerful Features
                </h2>
                <p class="mt-3 max-w-2xl mx-auto text-xl text-gray-500 dark:text-gray-400 sm:mt-4">
                    Everything you need for comprehensive market analysis
                </p>
            </div>
            
            <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3">
                <!-- Feature 1 -->
                <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 bg-blue-500 rounded-md p-3">
                                <i class="fas fa-chart-line text-white text-xl"></i>
                            </div>
                            <div class="ml-5">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">Technical Analysis</h3>
                            </div>
                        </div>
                        <p class="mt-3 text-base text-gray-500 dark:text-gray-400">
                            Advanced technical indicators and charting tools to help you make informed trading decisions.
                        </p>
                    </div>
                </div>
                
                <!-- Feature 2 -->
                <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 bg-green-500 rounded-md p-3">
                                <i class="fas fa-bell text-white text-xl"></i>
                            </div>
                            <div class="ml-5">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">Real-time Alerts</h3>
                            </div>
                        </div>
                        <p class="mt-3 text-base text-gray-500 dark:text-gray-400">
                            Get notified when your stocks hit target prices or show significant movements.
                        </p>
                    </div>
                </div>
                
                <!-- Feature 3 -->
                <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 bg-purple-500 rounded-md p-3">
                                <i class="fas fa-moon text-white text-xl"></i>
                            </div>
                            <div class="ml-5">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">Dark Mode</h3>
                            </div>
                        </div>
                        <p class="mt-3 text-base text-gray-500 dark:text-gray-400">
                            Comfortable viewing experience in any lighting condition with our dark theme.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-16 bg-white dark:bg-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="lg:text-center">
                <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white sm:text-4xl">
                    About Market Analyzer
                </h2>
                <p class="mt-4 max-w-2xl text-xl text-gray-500 dark:text-gray-400 lg:mx-auto">
                    Empowering traders with powerful market analysis tools
                </p>
            </div>

            <div class="mt-10">
                <div class="bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-8 md:p-12">
                    <div class="max-w-3xl mx-auto text-center">
                        <p class="text-lg text-gray-600 dark:text-gray-300">
                            Market Analyzer is a comprehensive tool designed to help both novice and experienced traders 
                            make better investment decisions through advanced technical analysis and real-time market data.
                        </p>
                        <div class="mt-6">
                            <a href="#" class="inline-flex items-center justify-center px-5 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200">
                                Get Started
                                <i class="fas fa-arrow-right ml-2"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Back to top button -->
    <div class="fixed bottom-8 right-8">
        <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-3 bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200" aria-label="Back to top">
            <i class="fas fa-arrow-up"></i>
        </button>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <!-- Application Scripts -->
    <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
    <script src="{{ url_for('static', filename='js/technical-analysis.js') }}"></script>
    <script src="{{ url_for('static', filename='js/chart.js') }}"></script>
    <script src="{{ url_for('static', filename='js/watchlist.js') }}"></script>
    <script src="{{ url_for('static', filename='js/signals.js') }}"></script>
    <!-- Enhancement Scripts -->
    <script src="{{ url_for('static', filename='js/enhancements.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    
    <!-- Theme Toggle Script -->
    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        
        // Check for saved theme preference or use system preference
        const savedTheme = localStorage.getItem('theme') || 
                          (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        
        // Apply saved theme
        if (savedTheme === 'dark') {
            html.classList.add('dark');
            themeToggle.innerHTML = '<i class="fas fa-sun text-yellow-300 text-xl"></i>';
        } else {
            html.classList.remove('dark');
            themeToggle.innerHTML = '<i class="fas fa-moon text-gray-600 text-xl"></i>';
        }
        
        // Toggle theme on button click
        themeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
            const isDark = html.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            themeToggle.innerHTML = isDark 
                ? '<i class="fas fa-sun text-yellow-300 text-xl"></i>' 
                : '<i class="fas fa-moon text-gray-600 text-xl">';
        });
    </script>

    <!-- Debug Information -->
    <div class="mt-8 p-4 bg-gray-100 rounded-lg text-xs text-gray-600">
        <h3 class="font-bold mb-2">Debug Information:</h3>
        <p>Show Shutdown: {{ show_shutdown }}</p>
        {% if debug_info %}
        <p>Client IP: {{ debug_info.client_ip }}</p>
        <p>User Agent: {{ debug_info.user_agent }}</p>
        {% endif %}
    </div>

    <!-- Shutdown button (always visible for now) -->
    <footer class="mt-6 text-center">
        <button 
            id="shutdownBtn" 
            class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full text-sm transition-colors duration-200"
            onclick="shutdownServer()">
            🛑 Shutdown Server
        </button>
    </footer>

    <script>
        // Shutdown server function
        async function shutdownServer() {
            if (confirm('Are you sure you want to shut down the server?')) {
                try {
                    // Show immediate feedback
                    document.getElementById('shutdownBtn').innerHTML = '⏳ Shutting down...';
                    document.getElementById('shutdownBtn').disabled = true;
                    
                    const response = await fetch('/shutdown');
                    
                    // If we get here, show the shutdown page
                    if (response.ok) {
                        const result = await response.text();
                        document.body.innerHTML = result;
                    }
                } catch (error) {
                    // This is expected when the server shuts down
                    document.body.innerHTML = `
                        <div style="font-family: Arial, sans-serif; text-align: center; margin-top: 50px;">
                            <h2>✅ Server has been shut down</h2>
                            <p>Thank you for using our application. You can close this window now.</p>
                        </div>
                    `;
                }
            }
        }
    </script>
</div>
{% endblock %}

{% block scripts %}
<!-- Add any page-specific scripts here -->
{% endblock %}
